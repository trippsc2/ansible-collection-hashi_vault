---
DOCUMENTATION:
  module: vault_kv1_secret_engine
  version_added: 1.0.0
  author:
    - Jim Tarpley (@trippsc2)
  short_description: Configures a KV version 1 secret engine in HashiCorp Vault.
  description:
    - Ensures a L(KV version 1 secret engine,https://hvac.readthedocs.io/en/stable/usage/secrets_engines/kv_v1.html)
      is configured as expected in HashiCorp Vault.
  extends_documentation_fragment:
    - trippsc2.hashi_vault.attributes
    - trippsc2.hashi_vault.auth
    - trippsc2.hashi_vault.connection
    - trippsc2.hashi_vault.engine_mount
    - trippsc2.hashi_vault.requirements
    - trippsc2.hashi_vault.secret_engine
EXAMPLES: |
  - name: Create KV version 1 secret engine
    trippsc2.hashi_vault.vault_kv1_secret_engine:
      url: https://vault:8201
      auth_method: userpass
      username: '{{ user }}'
      password: '{{ passwd }}'
      engine_mount_point: secret
      state: present

  - name: Remove KV version 1 secret engine
    trippsc2.hashi_vault.vault_kv1_secret_engine:
      url: https://vault:8201
      auth_method: userpass
      username: '{{ user }}'
      password: '{{ passwd }}'
      engine_mount_point: secret
      state: absent

RETURN:
  config:
    type: dict
    returned: O(state=present)
    description:
      - The configuration of the secret engine.
    sample:
      description: 'The KV1 secret engine.'
      default_lease_ttl: 2678400
      max_lease_ttl: 2678400
      audit_non_hmac_request_keys: []
      audit_non_hmac_response_keys: []
      listing_visibility: unauth
      passthrough_request_headers: []
    contains:
      description:
        type: str
        description:
          - The description of the secret engine.
      default_lease_ttl:
        type: int
        description:
          - The default lease TTL of the secret engine in seconds.
      max_lease_ttl:
        type: int
        description:
          - The maximum lease TTL of the secret engine in seconds.
      audit_non_hmac_request_keys:
        type: list
        elements: str
        description:
          - The list of non-HMAC request keys to audit.
      audit_non_hmac_response_keys:
        type: list
        elements: str
        description:
          - The list of non-HMAC response keys to audit.
      listing_visibility:
        type: str
        description:
          - The listing visibility of the secret engine.
      passthrough_request_headers:
        type: list
        elements: str
        description:
          - The list of request headers to pass through.
  prev_config:
    description:
      - The previous configuration of the secret engine.
    type: dict
    returned: changed
    sample:
      description: 'The KV1 secret engine.'
      default_lease_ttl: 2678400
      max_lease_ttl: 2678400
      audit_non_hmac_request_keys: []
      audit_non_hmac_response_keys: []
      listing_visibility: unauth
      passthrough_request_headers: []
    contains:
      description:
        type: str
        description:
          - The description of the secret engine.
      default_lease_ttl:
        type: int
        description:
          - The default lease TTL of the secret engine in seconds.
      max_lease_ttl:
        type: int
        description:
          - The maximum lease TTL of the secret engine in seconds.
      audit_non_hmac_request_keys:
        type: list
        elements: str
        description:
          - The list of non-HMAC request keys to audit.
      audit_non_hmac_response_keys:
        type: list
        elements: str
        description:
          - The list of non-HMAC response keys to audit.
      listing_visibility:
        type: str
        description:
          - The listing visibility of the secret engine.
      passthrough_request_headers:
        type: list
        elements: str
        description:
          - The list of request headers to pass through.
